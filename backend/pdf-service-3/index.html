<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Relatório do Projeto</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .container { max-width: 800px; margin: auto; padding: 20px; border: 1px solid #ccc; }
        h1 { color: #333; }
        p { line-height: 1.6; }
        button { padding: 10px 20px; background-color: #007bff; color: white; border: none; cursor: pointer; }
        #loading-message { display: none; color: #007bff; }
    </style>
</head>
<body>
    <div class="container" id="relatorio-content">
        <h1>Relatório Final do Projeto</h1>
        <p>Prezado(a) cliente,</p>
        <p>Este é o relatório final que detalha o progresso e os resultados do seu projeto. A formatação e os dados abaixo estão prontos para serem enviados por e-mail.</p>
        <hr>
        <h2>Status do Projeto: Concluído</h2>
        <ul>
            <li>Fase 1: <strong>100%</strong></li>
            <li>Fase 2: <strong>100%</strong></li>
            <li>Fase 3: <strong>100%</strong></li>
        </ul>
        <p>Agradecemos a confiança.</p>
    </div>
    
    <hr>
    
    <button onclick="enviarRelatorio()">Enviar Relatório por E-mail</button>
    <p id="loading-message">Enviando e-mail, por favor, aguarde...</p>

    <script>
        async function enviarRelatorio() {
            const button = document.querySelector('button');
            const loadingMessage = document.getElementById('loading-message');

            button.disabled = true;
            loadingMessage.style.display = 'block';

            const htmlContent = document.getElementById('relatorio-content').outerHTML;
            const backendUrl = "URL_DO_SEU_SERVICO_NO_CLOUD_RUN"; // Substitua pela URL do seu serviço no Cloud Run

            try {
                const response = await fetch(backendUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ html_content: htmlContent })
                });

                const result = await response.json();
                
                if (response.ok) {
                    alert('E-mail enviado com sucesso!');
                } else {
                    alert('Erro ao enviar e-mail: ' + result.error);
                }
            } catch (error) {
                alert('Ocorreu um erro na conexão: ' + error);
            } finally {
                button.disabled = false;
                loadingMessage.style.display = 'none';
            }
        }
    </script>
</body>
</html>